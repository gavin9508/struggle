## 类加载
类加载是指将.class文件从磁盘加载到内存的过程，**类的加载都是在程序运行期间完成的。**
### 加载步骤
    加载->连接（验证->准备->解析）->初始化->使用->卸载 
### 1.加载
    1.通过全类名获取定义此类的二进制字节流
    2.将字节流所代表的静态存储结构转换为方法区的运行时数据结构
    3.在内存中生成一个代表该类的 Class对象，作为方法区这些数据的访问入口
### 2.连接
#### 2.1 验证
文件格式验证->元数据验证->字节码验证->符号引用验证
#### 2.2 准备
准备阶段是正式为类变量（即静态变量）分配内存并设置类变量初始值的阶段，**这些内存都将在方法区中分配。**
#### 2.3 解析
解析阶段是虚拟机将常量池内的符号引用替换为直接引用的过程。解析动作主要针对类或接口、字段、类方法、接口方法、方法类型、方法句柄和调用限定符 7 类符号引用进行。（简单来说就是确定要用的方法是哪块内存）
### 3.初始化
初始化阶段是执行初始化方法 <clinit> ()方法的过程，是类加载的最后一步，这一步 JVM 才开始真正执行类中定义的 Java 程序代码(字节码)
### 4.使用
### 5.卸载
卸载类即该类的 Class 对象被 GC。
## 类加载器 
## 双亲委派模型

=====================
## 对象布局
对象在内存中存储的布局可以分为三块区域：**对象头（Header）、实例数据（Instance Data）和对齐填充（Padding）**
    
    1.对象头（Header）
        1).Mark Word(标记字段)：用于存储对象自身的运行时数据，如哈希码（HashCode）、GC分代年龄、锁状态标志、线程持有的锁、偏向线程ID、偏向时间戳等等
        2).Klass Pointer（Class对象指针）：即类型指针，是对象指向它的类元数据的指针，虚拟机通过这个指针来确定这个对象是哪个类的实例
        3).数组长度：如果对象是数组类型，记录数组长度
    2.对象实际数据（Instance Data）
        如果对象有属性字段，则这里会有数据信息。如果对象无属性字段，则这里就不会有数据。根据字段类型的不同占不同的字节，例如boolean类型占1个字节，int类型占4个字节等等
    3.对齐（Padding）
        如果上面的数据所占用的空间不能被8整除，padding则占用空间凑齐使之能被8整除。被8整除在读取数据的时候会比较快
    

=====================        
## 对象加载过程
1. 类加载检查
    
    首先检查能否在常量池中定位到这个类的符号引用，并且检查这个符号引用代表的类是否被加载、解析和初始化，如果没有则会先执行相应的类加载过程。
2. 内存分配

    类加载完后可确定对象所需的内存大小。**每个对象分配的内存大小是确定的**

   >  1.指针碰撞：堆内存规，用过的和未用过的用一个分界指针分界。分配时将指针后移，空出对象所需的内存即可。
   > 
   >  2.空闲列表：堆内存不规整，虚拟机维护一个记录内存是否可用的列表。分配时找到一块合适的内存空间给对象，同时更新空闲列表。
3. 初始化默认值

    将分配到的内存空间进行初始化（设置默认值）。保证java代码可以在不赋值的情况下使用。
4. 设置对象头

    对象头存放该对象的类信息、hash码、所处年龄段、锁标志等基本信息。
5. 执行初始化init方法

   初始化成员变量，执行实例化代码块，调用类的构造方法，并把堆内对象的首地址赋值给引用变量。

   > init是java文件编译之后在字节码文件中生成的。是一个实例构造器。
